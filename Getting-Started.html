<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Getting Started - LightNet</title>
        <link href="css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link href="css/codehilite.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap-3.0.3.min.js" defer></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">LightNet</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="index.html">Home</a>
                            </li>
                            <li class="active">
                                <a href="Getting-Started.html">Getting Started</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="Documentation/Introduction.html">Introduction</a>
</li>
                                    
<li >
    <a href="Documentation/Project-Structure.html">Project Structure</a>
</li>
                                    
<li >
    <a href="Documentation/Build-Options.html">Build Options</a>
</li>
                                    
<li >
    <a href="Documentation/Data-Structures.html">Data Structures</a>
</li>
                                    
<li >
    <a href="Documentation/Intermediate-Representation.html">Intermediate Representation</a>
</li>
                                    
<li >
    <a href="Documentation/Intermediate-Language.html">Intermediate Language</a>
</li>
                                    
<li >
    <a href="Documentation/Operator-Description.html">Operator Description</a>
</li>
                                    
<li >
    <a href="Documentation/Optimizer-Description.html">Optimizer Description</a>
</li>
                                    
<li >
    <a href="Documentation/Miscellaneous.html">Miscellaneous</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="Hacking.html">Hacking</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="index.html">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="Documentation/Introduction.html">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/zhaozhixu/LightNet"><i class="fa fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#getting-started">Getting Started</a></li>
            <li><a href="#installation">Installation</a></li>
            <li><a href="#model-format">Model Format</a></li>
            <li><a href="#usage">Usage</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h1>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<p>The following steps have been tested for Ubuntu 16.04 but should work with
other distros as well. </p>
<p>Most required packages can be installed using the following commands
(<code>sudo</code> permission may be required):</p>
<div class="codehilite"><pre><span></span>$ sudo apt-get install build-essential perl git pkg-config check
$ sudo cpan install JSON Sort::strverscmp
</pre></div>


<p>This project also depends on <a href="https://github.com/zhaozhixu/TensorLight">TensorLight</a>,
a lightweight tensor operation library. Install it according to 
<a href="https://github.com/zhaozhixu/TensorLight">its repository</a> before continuing to
build LightNet.</p>
<ul>
<li>
<p>(Optional) Packages for building documents</p>
<p>Use the following commands to install the packages for building documents:</p>
<div class="codehilite"><pre><span></span>$ sudo apt-get install python3-pip
$ pip3 install -U mkdocs markdown&gt;=3.1.1 pygments
</pre></div>


</li>
<li>
<p>(Optional) Packages for building python packages</p>
<p>Use the following commands to install the packages for building python packages 
(python3 for example):</p>
<div class="codehilite"><pre><span></span>$ sudo apt-get install python3-setuptools
</pre></div>


</li>
<li>
<p>(Optional) CUDA dependency</p>
<p>You also have to install CUDA 8.0 (or later) according to its website
<a href="http://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">CUDA Toolkit</a>
if you want to build with CUDA support.
Remember to put <code>nvcc</code> (usually in <code>/usr/local/cuda/bin</code>) in environment
variable <code>PATH</code>.</p>
</li>
<li>
<p>(Optional) cuDNN dependency</p>
<p>You also have to install CUDA 8.0 (or later) and cuDNN 7.0 (or later)
libraries, according to their websites
<a href="http://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">CUDA Toolkit</a> and 
<a href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html">cuDNN</a> 
if you want to build with cuDNN support.</p>
</li>
<li>
<p>(Optional) TensorRT dependency</p>
<p>You also have to install CUDA 8.0 (or later) and TensorRT 3.0 (or later) 
libraries, according to their websites
<a href="http://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html">CUDA Toolkit</a> and 
<a href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html">TensorRT</a>
if you want to build with TensorRT support.</p>
</li>
</ul>
<h3 id="building-and-installation">Building and Installation<a class="headerlink" href="#building-and-installation" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Clone this repository to your local directory.</p>
<div class="codehilite"><pre><span></span>$ cd &lt;my_working_directory&gt;
$ git clone https://github.com/zhaozhixu/LightNet.git
$ cd LightNet
</pre></div>


</li>
<li>
<p>Configure and build</p>
<p>First, configure your installation using:</p>
<div class="codehilite"><pre><span></span>$ chmod +x configure
$ ./configure
</pre></div>


<p>There are options to custom your building and installation process.
You can append them after <code>./configure</code>. For example, use</p>
<div class="codehilite"><pre><span></span>$ ./configure --install-dir=DIR
</pre></div>


<p>to set the installation directory (default is <code>/usr/local</code>). Use</p>
<div class="codehilite"><pre><span></span>$ ./configure --with-cuda=yes
</pre></div>


<p>if you want to build with CUDA support.</p>
<p>Detailed <code>./configure</code> options can be displayed using <code>./configure -h</code>.</p>
<p>After that, use <code>make</code> to compile the binaries, and run the test.
Finally, use <code>make install</code> to install the build directory into
the installation directory.</p>
</li>
<li>
<p>Other <code>make</code> options</p>
<p>Use <code>make info</code> to see other <code>make</code> options.
Especially, you can use <code>make clean</code> to clean up the build directory and all
object files, and <code>make uninstall</code> to remove installed files from
the installation directory.</p>
</li>
</ol>
<p>After compilation and installation, the following components will be installed:</p>
<ul>
<li><code>lightnet</code>: LightNet command line tool</li>
<li><code>liblightnet.so</code>: LightNet runtime library</li>
<li><code>il2json.pl</code>: LightNet intermediate language (IL) interpreter</li>
<li><code>pylightnet</code> (optional): LightNet python wrapper package</li>
</ul>
<h2 id="model-format">Model Format<a class="headerlink" href="#model-format" title="Permanent link">&para;</a></h2>
<p>LightNet uses an independent model format (or
<a href="Documentation/Intermediate-Representation.html">Intermediate Representation</a>, IR)
for neural network models, to provide the ability to support model
formats of all kinds of NN frameworks, and to provide the flexibility to perform
various optimization operations on the NN model.</p>
<p>The text-format IR directly consumed by LightNet is defined in a JSON format,
which is verbose and well-formed and can be easily parsed, although a little hard
for human to read (when the model gets bigger and has tens of thousands of lines). 
Thus we also provide a concise format for that JSON IR, 
called LightNet <a href="Documentation/Intermediate-Language.html">Intermediate Language</a>
(IL) for the ease of human reading, subfixed with <code>.net</code>.
There is of course a tool, <code>il2json.pl</code>, to carry out the task of translate 
the IL to JSON IR, which is installed by default.
Our sample models in <code>protos/net</code> directory are all written in IL.</p>
<p>For example, the following command translates the IL in <code>protos/net/yolov3.net</code> to 
the IR format <code>yolov3.json</code>.</p>
<div class="codehilite"><pre><span></span>$ il2json.pl protos/net/yolov3.net -o yolov3.json
</pre></div>


<p>Without <code>-o yolov3.json</code>, <code>il2json.pl</code> will print to stdout, which is useful when
combined with <code>lightnet</code> command line tool using pipes.</p>
<p>A model produced by another NN framework (such as Tensorflow) should be 
converted to an IR or IL model before compilation. LightNet has a subproject
in <code>tools/onnx2ln</code> that hopes to reduce the difficulty of that procedure.
By now, the most reliable way is (of course) to rewrite the NN model to the
concise IL format, which is often composed of only a hundred of lines or so.
And the other <code>tools/onnx2ln</code> method is still under development.</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>LightNet provides 3 interfaces which can be used by developers and users:</p>
<ul>
<li><a href="#command-line-interface">Command Line Interface</a></li>
<li><a href="#c-api">C API</a></li>
<li><a href="#python-api">Python API</a></li>
</ul>
<h3 id="command-line-interface">Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permanent link">&para;</a></h3>
<p>From the command line, type <code>lightnet -h</code> to display the program's usage.</p>
<p>The command line interface is designed for two purposes: </p>
<ol>
<li>Compile a neural network model to a more efficient model according to 
specified target platform.</li>
<li>Run the optimized model with fixed data for debug/test purpose.</li>
</ol>
<p>By default, <code>lightnet</code> both compiles the model and runs it with zeroed data.
Suppose there is a <code>yolov3.json</code> generated by the command in 
<a href="#model-format">Model Format</a> section:</p>
<div class="codehilite"><pre><span></span>$ il2json.pl protos/net/yolov3.net -o yolov3.json
</pre></div>


<p>Then the following command will compile the IR format model 
<code>yolov3.json</code>, save the compiled model in <code>out.json</code>, and run the compiled model 
with zeroed data.</p>
<div class="codehilite"><pre><span></span>$ lightnet -t tensorrt yolov3.json
</pre></div>


<p>Combined <code>il2json.pl</code>, more human-readable IL models can also be read, with 
pipes. In the following command, <code>il2json.pl</code> first reads the model in 
<code>protos/net/yolov3.net</code> and prints converted IR model to the pipe, then 
<code>lightnet</code> reads the model from the pipe (the trialing <code>-</code> tells <code>lightnet</code>
to read from stdin), compiles and runs it.</p>
<div class="codehilite"><pre><span></span>$ il2json.pl protos/net/yolov3.net | lightnet -t tensorrt -
</pre></div>


<p>Running the above command in LightNet's root directory will give you the 
the running time of the model:</p>
<div class="codehilite"><pre><span></span>info: run time: 0.017325s
</pre></div>


<p>To just compile a model without running it, use the <code>-c</code> option. Default output
file name is <code>out.json</code>, and <code>-o</code> option can change the output file name.</p>
<div class="codehilite"><pre><span></span>$ lightnet -t tensorrt -c -o yolov3-compiled.json yolov3.json
</pre></div>


<p>To just run a compiled model without compile it (again), use the <code>-r</code> option.</p>
<div class="codehilite"><pre><span></span>$ lightnet -r yolov3-compiled.json
</pre></div>


<p>And if you have prepared a specific
<a href="Documentation/Miscellaneous.html#data-file-format">data file</a>
for the tensors in the model (maybe the weights), you can specify it with 
<code>-f</code> option.</p>
<div class="codehilite"><pre><span></span>$ lightnet -r yolov3-compiled.json -f your-datafile.wts
</pre></div>


<h3 id="c-api">C API<a class="headerlink" href="#c-api" title="Permanent link">&para;</a></h3>
<p>An example using the C API is in <code>example/object-detect.c</code>. </p>
<p>This example performs an single-object detection algorithm using 
<a href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html">TensorRT</a>,
with <a href="https://arxiv.org/abs/1807.11164">ShuffleNetV2</a> as back-bone conv-net
and <a href="https://arxiv.org/abs/1612.01051">SqueezeDet</a>'s detection part as feature
expression algorithm. </p>
<p>To play with this demo, LightNet should be configured with</p>
<div class="codehilite"><pre><span></span>--with-tensorrt=yes
</pre></div>


<p>And to minimalize dependencies, this demo uses 
<a href="https://libjpeg-turbo.org">libjpeg</a> to read JPEG files, which requires
<code>libjpeg-dev</code> package to be installed, and can be installed in Ubuntu via</p>
<div class="codehilite"><pre><span></span>$ sudo apt-get install libjpeg-dev
</pre></div>


<p>After the compilation and installation of LightNet, you need to enter the
<code>example</code> directory and compile the demo:</p>
<div class="codehilite"><pre><span></span>$ cd example
$ make
</pre></div>


<p>Then, in the <code>example</code> directory, enter the following commands (the first
command is to translate the *.net IL model file into a JSON file that the
program can read):</p>
<div class="codehilite"><pre><span></span>$ il2json.pl data/shuffledet_dac.net -o data/out.json
$ ./object-detect data/out.json data/shuffledet_dac.wts data/images
</pre></div>


<p>And you should get a series of bounding boxes coordinates (xmin, ymin,
xmax, ymax), one for an input image, printed in the terminal like this:</p>
<div class="codehilite"><pre><span></span>[197.965088, 163.387146, 275.853577, 323.011322]
[197.478195, 161.533936, 276.260590, 322.812714]
[197.014648, 158.862747, 276.261810, 322.054504]
[196.676514, 160.987122, 275.435303, 322.000763]
[196.797455, 160.380035, 274.323181, 320.533020]
[196.917221, 161.277679, 273.463776, 319.580872]
......
frames per second of detection: 245.948881
</pre></div>


<p>In real projects, developers may draw the bounding boxes in the original image
with any libraries they like (such as OpenCV, GTK...).</p>
<h3 id="python-api">Python API<a class="headerlink" href="#python-api" title="Permanent link">&para;</a></h3>
<p>An example using the python API is in <code>example/detect.py</code> and demoed with
<code>example/object-detect.py</code>. This example does the same detection algorithm as
the <a href="#c-api">C API</a> demo.</p>
<p>To play with this demo, LightNet should be configured with</p>
<div class="codehilite"><pre><span></span>--with-tensorrt=yes --with-python=yes
</pre></div>


<p>And <a href="https://opencv.org">OpenCV</a> for Python3 should be installed. A possible
command for installation:</p>
<div class="codehilite"><pre><span></span>$ pip3 install -U opencv-python
</pre></div>


<p>After compilation and installation, enter the following
commands in the <code>example</code> directory (the first command is to translate
the *.net IL model file into a JSON file that the program can read):</p>
<div class="codehilite"><pre><span></span>$ il2json.pl data/shuffledet_dac.net -o data/out.json
$ ./object-detect.py data/out.json data/shuffledet_dac.wts data/images
</pre></div>


<p>Then you should get a dection window with bouding boxes detecting the images
in <code>example/data/images</code> dynamicly like the following screenshot, 
and a series of bounding boxes coordinates (xmin, ymin, xmax, ymax),
one for an input image, printed in the terminal.</p>
<p><img alt="Demo" src="img/demo.png" /></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="js/baidu_analyse.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
