/*
 * Copyright (c) 2018-2020 Zhao Zhixu
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/* NOTE: this file is automatically generated by protos/ep/ep_tensorrt.json
   using tools/addexpander.pl */

#include <assert.h>

#include "ln_arch.h"

#include "ln_tensorrt.h"

static ln_list *ep_create(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if ((({
        ln_op *next_op;
        ln_tensor_entry *te;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_op = ln_dfg_next(ctx->dfg, self, te->name);
        if (!next_op) {
            ret = 1;
        }
        ret;
    })
    )) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "create_cpu");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "conv2d"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "deconv2d"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "relu"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "maxpool2d"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "softmax"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "sigmoid"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "concat"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src1")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "concat"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src2")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "transform_bboxSQD"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src_delta")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "transform_bboxSQD"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src_anchor")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "rearange"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "submean"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "resize"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "upsample"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "dot_product"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src1")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    ) ||
        (({
        ln_list *next_ops;
        ln_op *next_op;
        ln_tensor_entry *te;
        ln_tensor_list_entry *tle_next;
        int ret = 0;

        te = ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst");
        next_ops = ln_dfg_nexts(ctx->dfg, self, te->name);
        if (next_ops) {
            LN_LIST_FOREACH(next_op, next_ops) {
                if (!ln_streq(next_op->op_arg->optype, "dot_product"))
                    continue;
                tle_next = ln_tensor_list_find_by_name(next_op->op_arg->tensors_in, te->name);
                if (tle_next && ln_streq(tle_next->arg_name, "src2")) {
                    ret = 1;
                    break;
                }
            }
            ln_list_free(next_ops);
        }
        ret;
    })
    )) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "create_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "create_cpu");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_create_cuda(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        *match = 0;
        return NULL;
    }
}

static ln_list *ep_conv2d(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int  last_index;
    char tmp_buf[LN_MAX_NAME_LEN];

   /* replace self with new ops */
    if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") < 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") < 0)) {
        ln_msg_inter_warn("ep_conv2d(): tensorrt doesn't support asymmetrical avgpool2d's 'padding', use conv2d_cuda instead");
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "conv2d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") >= 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") >= 0)) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "padding");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "padding")->array_len, ln_param_list_find(self->op_arg->params, "padding")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "conv");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_weight") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_weight", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_weight");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_bias") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_bias", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_bias");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_group") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_group", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_group");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_param_list_find(self->op_arg->params, "group")->value_int));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_output_c") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_output_c", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_output_c");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "weight")->tensor->dims[0]));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe,  2, (int[]){0,0});
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dilation") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dilation", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dilation");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "dilation")->array_len, ln_param_list_find(self->op_arg->params, "dilation")->value_array_int);
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }

    else if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "conv");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_weight") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_weight", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_weight");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_bias") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_bias", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_bias");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_group") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_group", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_group");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_param_list_find(self->op_arg->params, "group")->value_int));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_output_c") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_output_c", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_output_c");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "weight")->tensor->dims[0]));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, 2, (int[]){ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0], ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2]});
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dilation") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dilation", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dilation");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "dilation")->array_len, ln_param_list_find(self->op_arg->params, "dilation")->value_array_int);
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_deconv2d(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int  last_index;
    char tmp_buf[LN_MAX_NAME_LEN];

   /* replace self with new ops */
    if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") < 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") < 0)) {
        ln_msg_inter_warn("ep_deconv2d(): tensorrt doesn't support asymmetrical conv2d's 'padding', use deconv2d_cuda instead");
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "deconv2d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") >= 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") >= 0)) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "padding");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "padding")->array_len, ln_param_list_find(self->op_arg->params, "padding")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "deconv");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_weight") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_weight", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_weight");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_bias") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_bias", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_bias");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_group") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_group", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_group");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_param_list_find(self->op_arg->params, "group")->value_int));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_output_c") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_output_c", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_output_c");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "weight")->tensor->dims[0]));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe,  2, (int[]){0,0});
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }

    else if ((ln_param_list_find(self->op_arg->params, "output_padding")->value_array_int[0] != 0) ||
        (ln_param_list_find(self->op_arg->params, "output_padding")->value_array_int[1] != 0)) {
        ln_msg_inter_warn("ep_deconv2d(): tensorrt doesn't support deconv2d's none-zero 'output_padding' param, use deconv2d_cuda instead");
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "deconv2d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_param_list_find(self->op_arg->params, "dilation")->value_array_int[0] != 1) ||
        (ln_param_list_find(self->op_arg->params, "dilation")->value_array_int[1] != 1)) {
        ln_msg_inter_warn("ep_deconv2d(): tensorrt doesn't support deconv2d's none-one 'dilation' param, use deconv2d_cuda instead");
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "deconv2d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "deconv");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_weight") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_weight", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_weight");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "weight")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_bias") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_bias", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_bias");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "bias")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_group") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_group", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_group");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_param_list_find(self->op_arg->params, "group")->value_int));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_output_c") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_output_c", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_output_c");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims[1]));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, 2, (int[]){ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0], ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2]});
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_relu(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int last_index;

   /* replace self with new ops */
    if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "activation");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_activation_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_activation_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_activation_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kRELU");
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_lrelu(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "lrelu_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_sigmoid(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int last_index;

   /* replace self with new ops */
    if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "activation");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_activation_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_activation_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_activation_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kSIGMOID");
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_maxpool2d(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int  last_index;
    char tmp_buf[LN_MAX_NAME_LEN];

   /* replace self with new ops */
    if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") < 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") < 0)) {
        ln_msg_inter_warn("ep_maxpool2d(): tensorrt doesn't support asymmetrical maxpool2d's 'padding', use maxpool2d_cuda instead");
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "maxpool2d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") >= 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") >= 0)) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "padding");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "padding")->array_len, ln_param_list_find(self->op_arg->params, "padding")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "pooling");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_pooling_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_pooling_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_pooling_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kMAX");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe,  2, (int[]){0,0});
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }

    else if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "pooling");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_pooling_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_pooling_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_pooling_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kMAX");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, 2, (int[]){ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0], ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2]});
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_avgpool2d(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int  last_index;
    char tmp_buf[LN_MAX_NAME_LEN];

   /* replace self with new ops */
    if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") < 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") < 0)) {
        ln_msg_inter_warn("ep_avgpool2d(): tensorrt doesn't support asymmetrical avgpool2d's 'padding', use avgpool2d_cuda instead");
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "avgpool2d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2] && ln_tensorrt_version_cmp("4.0.0") >= 0) ||
        (ln_param_list_find(self->op_arg->params, "padding")->value_array_int[1] != ln_param_list_find(self->op_arg->params, "padding")->value_array_int[3] && ln_tensorrt_version_cmp("4.0.0") >= 0)) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "padding");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "padding")->array_len, ln_param_list_find(self->op_arg->params, "padding")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "pooling");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ({snprintf(tmp_buf, LN_MAX_NAME_LEN, "%s%s", ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name, "_padding"); tmp_buf;}));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_pooling_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_pooling_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_pooling_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kAVERAGE");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe,  2, (int[]){0,0});
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }

    else if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "pooling");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_pooling_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_pooling_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_pooling_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kAVERAGE");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_size") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_size", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_size");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "size")->array_len, ln_param_list_find(self->op_arg->params, "size")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_stride") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_stride", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_stride");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_param_list_find(self->op_arg->params, "stride")->array_len, ln_param_list_find(self->op_arg->params, "stride")->value_array_int);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_padding") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_padding", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_padding");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, 2, (int[]){ln_param_list_find(self->op_arg->params, "padding")->value_array_int[0], ln_param_list_find(self->op_arg->params, "padding")->value_array_int[2]});
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_softmax(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int last_index;

   /* replace self with new ops */
    if ((ln_param_list_find(self->op_arg->params, "axis")->value_int == 0) ||
        (ln_tensorrt_version_cmp("4.4.0") < 0 && ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->ndim < 4 && ln_param_list_find(self->op_arg->params, "axis")->value_int != 1) ||
        (ln_tensorrt_version_cmp("4.4.0") < 0 && ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->ndim >= 4 && ln_param_list_find(self->op_arg->params, "axis")->value_int != ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->ndim - 3)) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "softmax_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_tensorrt_version_cmp("4.4.0") < 0)) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "softmax");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }

    else if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "softmax");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_axes") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_axes", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_axes");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(0 | (1 << ln_param_list_find(self->op_arg->params, "axis")->value_int)));
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_concat(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int last_index;

   /* replace self with new ops */
    if ((ln_param_list_find(self->op_arg->params, "axis")->value_int == 0) ||
        (ln_tensorrt_version_cmp("4.0.0") < 0 && ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->ndim < 4 && ln_param_list_find(self->op_arg->params, "axis")->value_int != 1) ||
        (ln_tensorrt_version_cmp("4.0.0") < 0 && ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->ndim >= 4 && ln_param_list_find(self->op_arg->params, "axis")->value_int != ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->ndim - 3)) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "concat_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_tensorrt_version_cmp("4.0.0") < 0)) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "concat");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src1") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src1", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src1");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src2") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src2", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src2");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }

    else if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "concat");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src1") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src1", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src1");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src2") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src2", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src2");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_axis") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_axis", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_axis");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_number(pe, (double)(ln_param_list_find(self->op_arg->params, "axis")->value_int));
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_batchnorm(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int last_index;

   /* replace self with new ops */
    if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "bn2scale_wts_cpu");
        assert(op_proto);
        ln_op *bwc = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, bwc->op_arg->optype) > 0)
            ln_op_update_names(bwc, op_name_buf);
        new_ops = ln_list_append(new_ops, bwc);

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_in,
                                                                        "src_mean");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "mean")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_in,
                                                                        "src_var");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "var")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_in,
                                                                        "src_scale");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "scale")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_in,
                                                                        "src_offset");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "offset")->name);
        }

        {
            ln_param_entry *pe = ln_param_list_find(bwc->op_arg->params, "epsilon");
            ln_param_set_satu_number(pe, (double)(ln_param_list_find(self->op_arg->params, "epsilon")->value_float));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_out, "dst_shift")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_out, "dst_scale")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "weight");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_out, "dst_power")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "scale");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_shift") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_shift", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_shift");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_out, "dst_shift")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_scale") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_scale", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_scale");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_out, "dst_scale")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_power") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_power", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_power");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(bwc->op_arg->tensors_out, "dst_power")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_scale_mode") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_scale_mode", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_scale_mode");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "kCHANNEL");
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_elew(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */
    int last_index;

   /* replace self with new ops */
    if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "tensorrt");
        assert(op_proto);
        ln_op *trt = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, trt->op_arg->optype) > 0)
            ln_op_update_names(trt, op_name_buf);
        new_ops = ln_list_append(new_ops, trt);

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_in, arg_name, "src");
            trt->op_arg->tensors_in = ln_tensor_list_append(trt->op_arg->tensors_in, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_tensor_list_unique_arg_name(trt->op_arg->tensors_out, arg_name, "dst");
            trt->op_arg->tensors_out = ln_tensor_list_append(trt->op_arg->tensors_out, arg_name, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_shape") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_shape", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_shape");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_ARRAY_NUMBER);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_satu_array_int(pe, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->ndim, ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dims);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("dst") + strlen("_dtype") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "dst", last_index, "_dtype", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "dst", last_index, "_dtype");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_out, self->op_arg->tensor_table, "dst")->tensor->dtype));
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            last_index = ln_param_list_unique_arg_name(trt->op_arg->params, arg_name, "op");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, "elew");
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src1") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src1", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src1");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_src2") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_src2", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_src2");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_dst") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_dst", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_dst");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        {
            char arg_name[LN_MAX_NAME_LEN];
            if (strlen("op") + strlen("_elew_type") + ln_digit_num(last_index) >= LN_MAX_NAME_LEN)
                ln_msg_inter_error("name '%s%d%s' length exceeds LN_MAX_NAME_LEN = %d",
                                   "op", last_index, "_elew_type", LN_MAX_NAME_LEN);
            snprintf(arg_name, LN_MAX_NAME_LEN, "%s%d%s", "op", last_index, "_elew_type");
            trt->op_arg->params = ln_param_list_append_empty(trt->op_arg->params, arg_name, LN_PARAM_STRING);
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, arg_name);
            ln_param_set_string(pe, ln_tensorrt_elew_name(ln_param_list_find(self->op_arg->params, "elew_op")->value_string));
        }

        {
            ln_param_entry *pe = ln_param_list_find(trt->op_arg->params, "batch_size");
            ln_param_set_satu_number(pe, (double)(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->dims[0]));
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_dot_product(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *op_proto;
        ln_list *new_ops = NULL;
        char op_name_buf[LN_MAX_NAME_LEN];

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "create_cuda");
        assert(op_proto);
        ln_op *create_ws1 = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, create_ws1->op_arg->optype) > 0)
            ln_op_update_names(create_ws1, op_name_buf);
        new_ops = ln_list_append(new_ops, create_ws1);

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "create_cuda");
        assert(op_proto);
        ln_op *create_ws2 = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, create_ws2->op_arg->optype) > 0)
            ln_op_update_names(create_ws2, op_name_buf);
        new_ops = ln_list_append(new_ops, create_ws2);

        op_proto = ln_hash_find(LN_ARCH.op_proto_table, "dot_product_cuda");
        assert(op_proto);
        ln_op *dot = ln_op_create_with_names(op_proto, ctx->ops, ctx->tensor_table);
        if (ln_op_list_unique_name(new_ops, op_name_buf, dot->op_arg->optype) > 0)
            ln_op_update_names(dot, op_name_buf);
        new_ops = ln_list_append(new_ops, dot);

        {
            ln_param_entry *pe = ln_param_list_find(create_ws1->op_arg->params, "dtype");
            ln_param_set_string(pe, tl_dtype_name(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor->dtype));
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws1->op_arg->params, "dims");
            ln_param_set_satu_array_int(pe,  1, (int[]){tl_tensor_dot_product_cuda_ws_len(ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src1")->tensor)});
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws1->op_arg->params, "ran");
            ln_param_set_satu_array_double(pe,  2, (double[]){0, 0});
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws1->op_arg->params, "data");
            ln_param_set_satu_array_double(pe,  1, (double[]){0});
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws1->op_arg->params, "from_file");
            ln_param_set_bool(pe, LN_FALSE);
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws2->op_arg->params, "dtype");
            ln_param_set_string(pe, ln_param_list_find(create_ws1->op_arg->params, "dtype")->value_string);
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws2->op_arg->params, "dims");
            ln_param_set_satu_array_int(pe, ln_param_list_find(create_ws1->op_arg->params, "dims")->array_len, ln_param_list_find(create_ws1->op_arg->params, "dims")->value_array_int);
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws2->op_arg->params, "ran");
            ln_param_set_satu_array_double(pe, ln_param_list_find(create_ws1->op_arg->params, "ran")->array_len, ln_param_list_find(create_ws1->op_arg->params, "ran")->value_array_double);
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws2->op_arg->params, "data");
            ln_param_set_satu_array_double(pe, ln_param_list_find(create_ws1->op_arg->params, "data")->array_len, ln_param_list_find(create_ws1->op_arg->params, "data")->value_array_double);
        }

        {
            ln_param_entry *pe = ln_param_list_find(create_ws2->op_arg->params, "from_file");
            ln_param_set_bool(pe, ln_param_list_find(create_ws1->op_arg->params, "from_file")->value_bool);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(dot->op_arg->tensors_in,
                                                                        "src1");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src1")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(dot->op_arg->tensors_in,
                                                                        "src2");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_in, "src2")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(dot->op_arg->tensors_in,
                                                                        "ws1");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(create_ws1->op_arg->tensors_out, "dst")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(dot->op_arg->tensors_in,
                                                                        "ws2");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(create_ws2->op_arg->tensors_out, "dst")->name);
        }

        {
            ln_tensor_list_entry *tle = ln_tensor_list_find_by_arg_name(dot->op_arg->tensors_out,
                                                                        "dst");
            ln_free(tle->name);
            tle->name = ln_strdup(ln_tensor_list_find_by_arg_name(self->op_arg->tensors_out, "dst")->name);
        }

        *match = 1;
        return new_ops;
    }
}

static ln_list *ep_maxreduce(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "maxreduce_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_maxreduce_arg(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "maxreduce_arg_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_slice(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "slice_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_transpose(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "transpose_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_upsample(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "upsample_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_zeros(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "zeros_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_reshape(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "reshape_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_print(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if ((ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->mtype == LN_MEM_CPU)) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "print_cpu");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->mtype == LN_MEM_CUDA)) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "print_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if (1) {
        ln_msg_inter_error("ep_print(): print's src is either of LN_MEM_CPU or LN_MEM_CUDA");
        return NULL;
    }
}

static ln_list *ep_fprint(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if ((ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->mtype == LN_MEM_CPU)) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "fprint_cpu");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if ((ln_tensor_list_find_entry(self->op_arg->tensors_in, self->op_arg->tensor_table, "src")->mtype == LN_MEM_CUDA)) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "fprint_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }

    else if (1) {
        ln_msg_inter_error("ep_fprint(): fprint's src is either of LN_MEM_CPU or LN_MEM_CUDA");
        return NULL;
    }
}

static ln_list *ep_sort1d(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "sort1d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_sort1d_by_key(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "sort1d_by_key_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_arange(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "arange_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_rearange(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "rearange_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_resize(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "resize_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_submean(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "submean_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_transform_bboxSQD(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "transform_bboxSQD_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_pick1d(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "pick1d_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_detect_yolov3(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        ln_op *new_op = ln_op_copy_to_optype(LN_ARCH.op_proto_table,
                                             self, "detect_yolov3_cuda");
        *match = 1;
        return ln_list_append(NULL, new_op);
    }
}

static ln_list *ep_tensorrt(const ln_context *ctx, const ln_op *self, int *match)
{
    /* auto variables */


   /* replace self with new ops */
    if (1) {
        *match = 0;
        return NULL;
    }
}

static ln_hash_init_entry init_ep_funcs[] = {
    {"create", ep_create},
    {"create_cuda", ep_create_cuda},
    {"conv2d", ep_conv2d},
    {"deconv2d", ep_deconv2d},
    {"relu", ep_relu},
    {"lrelu", ep_lrelu},
    {"sigmoid", ep_sigmoid},
    {"maxpool2d", ep_maxpool2d},
    {"avgpool2d", ep_avgpool2d},
    {"softmax", ep_softmax},
    {"concat", ep_concat},
    {"batchnorm", ep_batchnorm},
    {"elew", ep_elew},
    {"dot_product", ep_dot_product},
    {"maxreduce", ep_maxreduce},
    {"maxreduce_arg", ep_maxreduce_arg},
    {"slice", ep_slice},
    {"transpose", ep_transpose},
    {"upsample", ep_upsample},
    {"zeros", ep_zeros},
    {"reshape", ep_reshape},
    {"print", ep_print},
    {"fprint", ep_fprint},
    {"sort1d", ep_sort1d},
    {"sort1d_by_key", ep_sort1d_by_key},
    {"arange", ep_arange},
    {"rearange", ep_rearange},
    {"resize", ep_resize},
    {"submean", ep_submean},
    {"transform_bboxSQD", ep_transform_bboxSQD},
    {"pick1d", ep_pick1d},
    {"detect_yolov3", ep_detect_yolov3},
    {"tensorrt", ep_tensorrt},
    LN_HASH_INIT_ENTRY_NULL
};
static ln_hash *ep_funcs_hash = NULL;

void ln_expander_init_tensorrt(void **priv_p)
{
    ep_funcs_hash = ln_hash_create(ln_str_hash, ln_str_cmp, NULL, NULL);
    ln_hash_init(ep_funcs_hash, init_ep_funcs);
}

void ln_expander_cleanup_tensorrt(void **priv_p)
{
    ln_hash_free(ep_funcs_hash);
}

ln_list *ln_expander_tensorrt(const ln_context *ctx, const ln_op *self, int *match)
{
    ln_expander_func  ep_func;
    ln_list          *new_ops;
    void             *value;

    if (!ln_hash_find_extended(ep_funcs_hash, self->op_arg->optype, NULL, &value))
        ln_msg_inter_error("unsupported optype '%s' for tensorrt expander",
                           self->op_arg->optype);

    ep_func = value;
    new_ops = ep_func(ctx, self, match);

    return new_ops;
}
